<! Doctype HTML>
<html>
    <head>
        <title></title>

    </head>
    <body>

        <script type="module">
            import { Optimizer } from '../Optimizer.js';

            // wait for x milliseconds
            function wait(ms) {

                const start = window.performance.now();
                while (window.performance.now() < start + ms) {}

            }

            // optimize the work time until we reach the target framerate
            const optimizer = new Optimizer();
            optimizer.addTweak(delta => {

                workTime += delta < 0 ? -1 : 1;

                console.log('Optimized workTime to ', workTime, 'ms');
                return true;

            });

            // work loop
            let workTime = 100;
            (function loop(){

                optimizer.update();

                console.log(`waiting for ` + workTime);
                wait(workTime);
                requestAnimationFrame(loop);

            })();

        </script>
    </body>
</html>
